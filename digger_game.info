file bin/digger/game.bin 1000
include mmio.info
option noconv
option noflex


comment 0040 -----------------------------------------------------------------------------
comment 0040 -
comment 0040 -	Tile Id Key
comment 0040 -
comment 0040 -	0	Blank
comment 0040 -	1	Red Brick (solid)
comment 0040 -	2	Red Brick (fall thru)
comment 0040 -	3	Green Brick (undiggable)
comment 0040 -	4	Rope/Bar
comment 0040 -	5	Ladder
comment 0040 -	6	Gold
comment 0040 -	7	Guard
comment 0040 -	8	Player
comment 0040 -	9	Exit
comment 0040 -	10	Girder
comment 0040 -
comment 0040 ------------------------------------------------------------------------------


*
* Constant values mistaken for labels
*
comment 0040 
comment 0040 
comment 0040 
comment 0040 ------------------------------------------------------------------------------
comment 0040 Global variables
comment 0040 ------------------------------------------------------------------------------
label 0000 $0000
label 00C8 $00C8
label 0168 $0168
label 0205 $0205
label 0216 $0216
label 0305 $0305
label 0409 $0409
label 0800 $0800
label 1568 +$1568
label 1586 +$1586
label 2020 +$2020
label 3005 +$3005
label 3031 +$3031
label 3233 +$3233
label 3458 +$3458
label 4080 +$4080
label 4C80 +$4C80
label 6000 $6000
label A0B3 $A0B3
label B1AF $B1AF


*
* Global variables
*
rmb 0040-00b0
label 0017 STACKPTR	RMB 1
label 0040 SCRAT1 RMB 1
label 0041 SCRAT2 RMB 1
label 0042 SCRAT3 RMB 1
label 0043 FALL   RMB 1
label 0044 NUMGLD RMB 1 Number of gold bars
label 0045 DODIG  RMB 1 Do DIG sequence? 0=no
label 0046 DIGCOR RMB 2 Address of dig block
label 0048 DIGSCR RMB 2 Address of dig block on screen
label 004a DIGCNT RMB 1 Count for dig restore
label 004b EXTCOR RMB 2 Exit x,y coordinates in maze
label 004c EXTCOR+1
label 004d ONBAR  RMB 1 On bar when falling? 0=no
label 004e GXMOVE RMB 1 Is gaurd x greater than man x 0=no
label 004f GYMOVE RMB 1 Is gaurd y greater than man y 0=no
label 0050 CLEFT  RMB 1 Move left?
label 0051 CRIGHT RMB 1 Move right?
label 0052 CUP    RMB 1 Move up?
label 0053 CDOWN  RMB 1 Move down?
label 0054 LLEFT  RMB 1 Move left off of ladder?
label 0055 LRIGHT RMB 1 Move right off of ladder?
label 0056 GRDUND RMB 1 Is there a gaurd under the current position
label 0057 LIVES  RMB 1 Number of lives
label 0058 MANCOR_OR_MANDAT RMB 2 Man screen coordinates
label 005a MANX0  RMB 1 Man block x coordinates
label 005b MANY0  RMB 1 Man block y coordinates
label 005c MANX1  RMB 1 Man fine x coordinates
label 005d MANY1  RMB 1 Man fine y coordinates
label 005e MANTYP RMB 1 Man put type
label 005f MANSTT RMB 1 Man status (not used)
label 0060 TEMP0  RMB 2
label 0062 LEVEL  RMB 1
label 0063 EXCOR  RMB 1
label 0064 EYCOR  RMB 1
label 0065 WIDTH  RMB 1 Width of sprite (always 4 bytes)
label 0066 HIGH   RMB 1 Heigth of sprite (always 9)
label 0067 NUMGRD RMB 1 Number of gaurds
label 0068 GAURDS RMB 8*8 Gaurd data (up to 8)
label 00a8 SCORE  RMB 3
label 00A9 SCORE+1
label 00AA SCORE+2
label 00ab XCOR   RMB 1
label 00ac YCOR   RMB 1
label 00ad COOR   RMB 2
label 00af DOTEST RMB 1
label 00b0 SPEED  RMB 1

lcomment 0017 ----- STACKPTR
lcomment 0040 ----- SCRAT1
lcomment 0041 ----- SCRAT2
lcomment 0042 ----- SCRAT3
lcomment 0043 ----- FALL
lcomment 0044 Number of gold bars
lcomment 0045 Do DIG sequence? 0=no
lcomment 0046 Address of dig block
lcomment 0048 Address of dig block on screen
lcomment 004a Count for dig restore
lcomment 004b Exit x,y coordinates in maze
lcomment 004d On bar when falling? 0=no
lcomment 004e Is gaurd x greater than man x 0=no
lcomment 004f Is gaurd y greater than man y 0=no
lcomment 0050 Move left?
lcomment 0051 Move right?
lcomment 0052 Move up?
lcomment 0053 Move down?
lcomment 0054 Move left off of ladder?
lcomment 0055 Move right off of ladder?
lcomment 0056 Is there a gaurd under the current position
lcomment 0057 Number of lives
lcomment 0058 Man screen coordinates
lcomment 005a Man block x coordinates
lcomment 005b Man block y coordinates
lcomment 005c Man fine x coordinates
lcomment 005d Man fine y coordinates
lcomment 005e Man put type
lcomment 005f Man status (not used)
lcomment 0060 ----- TEMP0
lcomment 0062 ----- LEVEL
lcomment 0063 ----- EXCOR
lcomment 0064 ----- EYCOR
lcomment 0065 Width of sprite (always 4 bytes)
lcomment 0066 Heigth of sprite (always 9)
lcomment 0067 Number of gaurds
lcomment 0068 Gaurd data (up to 8)
lcomment 00a8 ----- SCORE
lcomment 00ab ----- XCOR
lcomment 00ac ----- YCOR
lcomment 00ad ----- COOR
lcomment 00af ----- DOTEST
lcomment 00b0 ----- SPEED


*
* Misc defs
*
label 0EF0 RESERV
label 8000 FRAME_BUFFER
label 8004 FRAME_BUFFER+4
label C004 ROM_VECTOR_DSKCON
label FD00 FRAME_BUFFER_END


comment 1000
comment 1000 -----------------------------------------------------------------------------
comment 1000 Indirect entry point
comment 1000 -----------------------------------------------------------------------------
word 1000-1001




comment 1002  
comment 1002  
comment 1002  
comment 1002 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
comment 1002 From HPRINT.ASM

comment 1002
comment 1002 -----------------------------------------------------------------------------
comment 1002 Dirty region restore buffer?
comment 1002 -----------------------------------------------------------------------------
data 1002-1034
label 1032 RESTOREBUFFER_BOTTOM
label 1034 RESBUF


comment 1035
comment 1035 -----------------------------------------------------------------------------
comment 1035 Retrieve level from package and set up for game
comment 1035 -----------------------------------------------------------------------------
label 1035 RETRV
label 1051 RETRV_COPYLOOP


comment 106E
comment 106E -----------------------------------------------------------------------------
comment 106E Find a tile in the active level. If the tile is found it is reset to blank (0)
comment 106E -----------------------------------------------------------------------------
label 106E RETRV_FINDTILE
label 1075 RETRV_FINDTILE_ROWLOOP
label 1079 RETRV_FINDTILE_LINELOOP
label 108C RETRV_FINDTILE_FOUND


comment 1091
comment 1091 -----------------------------------------------------------------------------
comment 1091 Collect actors (guards, player, exit) and init game state data
comment 1091 -----------------------------------------------------------------------------
label 1091 RETRV_COLLECTACTORS
label 109C RETRV_EXITNOTFOUND
label 10B7 RETRV_FINDGUARDLOOP
label 10D9 RETRV_DONE


comment 10DA
comment 10DA -----------------------------------------------------------------------------
comment 10DA Count gold bars in level
comment 10DA -----------------------------------------------------------------------------
label 10DA CountGoldBars
label 10DF CountGoldBars_Loop
label 10EE CountGoldBars_Done


comment 10EF
comment 10EF -----------------------------------------------------------------------------
comment 10EF Translate to screen coordinates
comment 10EF -----------------------------------------------------------------------------
label 10EF DOCOOR


comment 1104
comment 1104 -----------------------------------------------------------------------------
comment 1104 Draw tile/block on the screen
comment 1104 -----------------------------------------------------------------------------
label 1104 PUTBLK


comment 1163
comment 1163 -----------------------------------------------------------------------------
comment 1163 Draw the screen (game mode)
comment 1163 -----------------------------------------------------------------------------
label 1163 DOSCRN
label 116E DOSCRN_ROWLOOP
label 1170 DOSCRN_COLUMNLOOP


comment 1180
comment 1180 -----------------------------------------------------------------------------
comment 1180 Cycle tile animations and update the display accordingly.
comment 1180 -----------------------------------------------------------------------------
label 1180 UPDATE
label 118B UPDATE_ADVANCE_ANIM
label 118F UPDATE_ADVANCE_LOOP
label 119A UPDATE_ADVANCE_SETTILE
label 11A3 UPDATE_ADVANCE_ENDANIM
label 11A7 UPDATE_REDRAW
label 11B2 UPDATE_REDRAW_ROWLOOP
label 11B4 UPDATE_REDRAW_COLUMNLOOP
label 11CF UPDATE_REDRAW_SKIPTILE


comment 11DD
comment 11DD -----------------------------------------------------------------------------
comment 11DD Check if player is in same block as gold bar
comment 11DD -----------------------------------------------------------------------------
label 11DD CHKGLD
label 121D CHKGLD_DONE


comment 121E
comment 121E -----------------------------------------------------------------------------
comment 121E Erase 8x9 pixel area with background color
comment 121E -----------------------------------------------------------------------------
label 121E Screen_EraseBlock
label 122E Screen_EraseBlock0


comment 1241
comment 1241 -----------------------------------------------------------------------------
comment 1241 Adds the escape latter to the display and map
comment 1241 -----------------------------------------------------------------------------
label 1241 EscapeLadder_Apply
label 124B EscapeLadder_ApplyToMap_Loop
label 1269 EscapeLadder_ApplyToScreen_Loop


comment 1282
comment 1282 -----------------------------------------------------------------------------
comment 1282 Translate X,Y coordinates to screen address
comment 1282 -----------------------------------------------------------------------------
label 1282 HPrint_CalcPosition


comment 1295
comment 1295 -----------------------------------------------------------------------------
comment 1295 Set the video display address
comment 1295 -----------------------------------------------------------------------------
data 1295
label 1295 VIDEO_PAGE
label 1296 INIT_VIDEO


comment 12C3
comment 12C3 -----------------------------------------------------------------------------
comment 12C3 Clear the screen with the specified color
comment 12C3 -----------------------------------------------------------------------------
label 12C3 Screen_Clear
label 12DC Screen_Clear0


comment 12F7
comment 12F7 -----------------------------------------------------------------------------
comment 12F7 MMU bank selection helpers
comment 12F7 -----------------------------------------------------------------------------
data 12F7-1316
label 12F7 MMUDATA_APP
label 1307 MMUDATA_ROM
label 1317 MMU1
label 131C MMU2
label 131F SETMMU
label 1329 SETMMU_LOOP


comment 1335
comment 1335 -----------------------------------------------------------------------------
comment 1335 Vertical sync polling helper
comment 1335 -----------------------------------------------------------------------------
label 1335 VHOLD
label 1338 VHOLD_POLLSYNC


comment 133E 
comment 133E -----------------------------------------------------------------------------
comment 133E Blit a sprite to the screen
comment 133E -----------------------------------------------------------------------------
label 133E PUT
label 1344 PUT_DRAWROWLOOP
label 1346 PUT_DRAWCOLUMNLOOP


comment 135B 
comment 135B -----------------------------------------------------------------------------
comment 135B Retrieves the block information around the specified coordinate to determine
comment 135B directions actor is allowed to move in
comment 135B -----------------------------------------------------------------------------
label 135B SETBLK
label 138E SETBLK0
label 13A2 SETBLK1
label 13B9 SETBLK2
label 13C8 SETBLK3
label 13DB SETBLK4
label 13EE SETBLK5
label 13FD SETBLK6
label 140E SETBLK7
label 1414 SETBLK8
label 1416 SETBLK9


comment 141B 
comment 141B -----------------------------------------------------------------------------
comment 141B Read position of left joystick
comment 141B -----------------------------------------------------------------------------
data 141B-141e
label 141D LEFTX
label 141E LEFTY
label 141F SelectLeftJoystick
label 1424 SelectJoystick
label 1431 SelectJoystick0
label 1436 SampleJoystick
label 143F SampleJoystick0
label 1442 GETJOY
label 144B GETJOY0
label 1451 GETJOY1
label 1454 GETJOY2
label 1466 GETJOY3
label 1468 GETJOY4
label 1479 GETJOY5


comment 1482 
comment 1482 -----------------------------------------------------------------------------
comment 1482 Random Number Generator
comment 1482 -----------------------------------------------------------------------------
word 1482
data 1484
label 1482 RND
label 1484 SEED
label 1485 random
label 14A9 Actor_Random


comment 14B9 
comment 14B9 -----------------------------------------------------------------------------
comment 14B9 Transition level onto screen
comment 14B9 -----------------------------------------------------------------------------
data 14B9-14ba
label 14B9 TRANSITION_WIDTH
label 14BA TRANSITION_HEIGHT
label 14BB MAKE
label 14C6 MAKE_DRAW
label 14CC MAKE_DRAWTOP
label 14E0 MAKE_DRAWRIGHT
label 14F8 MAKE_DRAWBOTTOM
label 150D MAKE_DRAWLEFT
label 153E MAKE_DELAYLOOP
label 1545 MAKE_DONE


comment 1546 
comment 1546 -----------------------------------------------------------------------------
comment 1546 Transition level off screen
comment 1546 -----------------------------------------------------------------------------
label 1546 CLEAR
label 154F CLEAR_LOOP
label 1553 CLEAR_DOTOP
label 155B CLEAR_DORIGHT
label 156A CLEAR_DOBOTTOM
label 1572 CLEAR_DOLEFT
label 1599 CLEAR_DELAYLOOP
label 159F CLEAR_DRAWLAST
label 15A1 CLEAR_DRAWLASTLOOP


comment 15AB 
comment 15AB -----------------------------------------------------------------------------
comment 15AB Keyboard driver with key repeat (INKEY) 
comment 15AB -----------------------------------------------------------------------------
data 15AB-15BB
word 15BC-15D7
label 15AB CASE
label 15AC DEBNCE
label 15AE KEYBUF
label 15B6 KEYBUF+8
label 15B7 REPT1
label 15B8 REPT2
label 15B9 REPT3
label 15BA REPSPD
label 15BB REPTIM
label 15BC KEYTABLE
label 15D8 REPEAT
label 15DB REP0
label 15ED REP5
label 15F9 REP1
label 1609 REP6
label 1619 REP7
label 1621 REP8
label 1629 INKEY
label 164C INKEY8
label 165F INKEY9
label 1661 INKEYD
label 1663 KEYIN
label 1674 ROTATE
label 168F CONV
label 16A7 ASCII
label 16BB RECOVR
label 16C6 NOKEY
label 16C7 RETURN
label 16C9 TESTSH
label 16CB TEST
label 16D3 TESTCT
label 16D7 TESTAT
label 16DB READ
label 16DD READ0
label 16E7 REDRET
label 16E8 AT
label 16EA SPECIL
label 1700 KSHIFT
label 1707 SPEC0
label 170D GETASC
label 1711 DELAY


comment 1716 
comment 1716 -----------------------------------------------------------------------------
comment 1716 Convert 16 bit unsigned value (ACCD) to string
comment 1716 -----------------------------------------------------------------------------
data 1716-1728
word 1716-1721
hex 171a-171b
label 1716 NUMTABLE
label 1722 NUMBER
label 1724 NUMBER+2
label 1725 NUMBER+3
label 1726 NUMBER+4
label 1727 NUMBER+5
label 1728 NUMBUFCNT
label 1729 NUMOUT
label 1738 NUMOUT_RESETBUFFERLOOP
label 1749 NUMOUT_TODIGITLOOP
label 1755 NUMOUT_SAVEDIGIT
label 1772 NUMOUT_TRIMLEADERLOOP
label 177F NUMOUT_DONE


comment 1781 
comment 1781 -----------------------------------------------------------------------------
comment 1781 Line Input
comment 1781 -----------------------------------------------------------------------------
data 1781-17B7
label 1781 LINEINPUT_TEXT
label 1782 LINEINPUT_XPOSITION
label 1783 LINEINPUT_YPOSITION
label 1784 LINEINPUT_BUFFER
label 17B6 LINEINPUT_CURSORPTR
label 17B7 LINEINPUT_CURSORMAX
label 17B8 LINEINPUT
label 17C6 LINEINPUT_RESETBUFLOOP
label 17CD LINEINPUT_PRINTLINE
label 17D3 LINEINPUT_POLLKEYBOARD
label 17FF LINEINPUT_ONENTER
label 1800 LINEINPUT_ONBACKSPACE
label 1814 LINEINPUT_ONCLEAR
label 181A LINEINPUT_ONBREAK


comment 181F 
comment 181F -----------------------------------------------------------------------------
comment 181F Print a string to the graphics screen
comment 181F NOTE: Color information and position are the first 3 bytes of the string
comment 181F -----------------------------------------------------------------------------
data 181F-1822
label 181F HPRINT_YCHUNK_COUNT
label 1820 HPRINT_XPOSITION
label 1821 HPRINT_COOR
label 1823 HPRINT
label 1827 HPRINT_PARSEPOSITION
label 183A HPRINT_PARSECHAR
label 184B HPRINT_NEWLINE
label 1859 HPRINT_GETGLYPHADDRESS
label 1869 HPRINT_DRAWLINESLOOP
label 18AD HPRINT_EXIT




comment 18AF  
comment 18AF  
comment 18AF  
comment 18AF @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
comment 18AF From GRAPHICS.ASM

comment 18AF 
comment 18AF -----------------------------------------------------------------------------
comment 18AF Font used by HPRINT
comment 18AF -----------------------------------------------------------------------------
data 18AF-3491
label 18AF FONTDATA


comment 24AF 
comment 24AF -----------------------------------------------------------------------------
comment 24AF Player sprite table and textures
comment 24AF -----------------------------------------------------------------------------
word 24AF-24BE
label 24AF MANTAB
label 24BF MANSPRITE0
label 2507 MANSPRITE1
label 254F MANSPRITE2
label 2597 MANSPRITE3
label 25DF MANSPRITE4
label 2627 MANSPRITE5


comment 266F 
comment 266F -----------------------------------------------------------------------------
comment 266F Guard sprite table and textures
comment 266F -----------------------------------------------------------------------------
word 266F-2682
label 266F GRDTAB
label 2683 GRDSPRITE0
label 26CB GRDSPRITE1
label 2713 GRDSPRITE2
label 275B GRDSPRITE3
label 27A3 GRDSPRITE4
label 27EB GRDSPRITE5


comment 2833 
comment 2833 -----------------------------------------------------------------------------
comment 2833 Title image in MGE/RLE encoded format
comment 2833 -----------------------------------------------------------------------------
label 2833 TITLE_IMAGE


comment 2E1C 
comment 2E1C -----------------------------------------------------------------------------
comment 2E1C Background tiles (8x9 pixels) use for normal game play
comment 2E1C -----------------------------------------------------------------------------
label 2E1C TILEMAP_TEXTURE


comment 3254 
comment 3254 -----------------------------------------------------------------------------
comment 3254 Background tiles (8x9 pixels) use for editor (maybe test play)
comment 3254 -----------------------------------------------------------------------------
label 3254 Editor_TilemapTexture




comment 3494  
comment 3494  
comment 3494  
comment 3494 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
comment 3494 From EDITOR.ASM

comment 3494 
comment 3494 -----------------------------------------------------------------------------
comment 3494 Load the specified level for editing
comment 3494 -----------------------------------------------------------------------------
label 3494 Editor_LoadLevel
label 34B1 Editor_LoadLevel_Loop


comment 34CA 
comment 34CA -----------------------------------------------------------------------------
comment 34CA Resets the level to a default state in the editor
comment 34CA -----------------------------------------------------------------------------
label 34CA Editor_ClearLevel
label 34CD Editor_ClearLevel_Loop
label 34DB Editor_ClearLevel_LastRowLoop


comment 34E1 
comment 34E1 -----------------------------------------------------------------------------
comment 34E1 Save the specified level into the level package
comment 34E1 -----------------------------------------------------------------------------
data 34E1-34f0
label 34E1 Editor_NibbleConvTable
label 34F1 Editor_SaveLevel
label 3511 Editor_SaveLevel_Loop


comment 3522 
comment 3522 -----------------------------------------------------------------------------
comment 3522 Save the specified level into the level package
comment 3522 -----------------------------------------------------------------------------
label 3522 Editor_DrawCursor
label 3539 Editor_DrawCursor0


comment 354A 
comment 354A -----------------------------------------------------------------------------
comment 354A Draw the tile for editor
comment 354A -----------------------------------------------------------------------------
label 354A Editor_DrawTile


comment 35A9 
comment 35A9 -----------------------------------------------------------------------------
comment 35A9 Draw the level for editing
comment 35A9 -----------------------------------------------------------------------------
label 35A9 Editor_DrawLevel
label 35B9 Editor_DrawLevel_RowLoop
label 35BB Editor_DrawLevel_ColumnLoop


comment 35Cd 
comment 35Cd -----------------------------------------------------------------------------
comment 35Cd Text string for level currently being edited
comment 35Cd -----------------------------------------------------------------------------
data 35Cd-35d8
word 35Ce
label 35CD Message_CurrentLevel
label 35D6 Message_CurrentLevelVal


comment 35D9 
comment 35D9 -----------------------------------------------------------------------------
comment 35D9 Main editor loop
comment 35D9 -----------------------------------------------------------------------------
data 35F2-35FE
label 35D9 Editor_Run
label 35F2 Editor_KeyToTileTable
label 35FE Editor_CurrentTileIndex
label 35FF Editor_RunEx
label 3602 Editor_Run_PollKeyboard
label 3650 Editor_Run_RemapKeyLoop


comment 365D 
comment 365D -----------------------------------------------------------------------------
comment 365D Move the cursor left
comment 365D -----------------------------------------------------------------------------
label 365D Editor_OnCursorLeft


comment 366B 
comment 366B -----------------------------------------------------------------------------
comment 366B Move the cursor right
comment 366B -----------------------------------------------------------------------------
label 366B Editor_OnCursorRight


comment 367C 
comment 367C -----------------------------------------------------------------------------
comment 367C Move the cursor up
comment 367C -----------------------------------------------------------------------------
label 367C Editor_OnCursorUp


comment 368D 
comment 368D -----------------------------------------------------------------------------
comment 368D Move the cursor down
comment 368D -----------------------------------------------------------------------------
label 368D Editor_OnCursorDown


comment 36A0 
comment 36A0 -----------------------------------------------------------------------------
comment 36A0 Change the tile at the cursor location to the one specified in Editor_CurrentTileIndex
comment 36A0 -----------------------------------------------------------------------------
label 36A0 Editor_ChngTile
label 36AB Editor_ChngTileEx
label 36DF Editor_ChngTile_Erase
label 36E2 Editor_ChngTile_EraseLoop
label 36EA Editor_ChngTile_EraseSet


comment 36F6 
comment 36F6 -----------------------------------------------------------------------------
comment 36F6 Go to the previous level. If at first go to last
comment 36F6 -----------------------------------------------------------------------------
label 36F6 Editor_OnNextLevel
label 3702 Editor_OnNextLevel0


comment 3729 
comment 3729 -----------------------------------------------------------------------------
comment 3729 Go to the next level. If at last go to first
comment 3729 -----------------------------------------------------------------------------
label 3729 Editor_OnPreviousLevel
label 3735 Editor_OnPreviousLevel0


comment 3739 
comment 3739 -----------------------------------------------------------------------------
comment 3739 Reset to a blank level with a single row of diggable blocks at the bottom
comment 3739 -----------------------------------------------------------------------------
label 3739 Editor_OnResetLevel


comment 3748 
comment 3748 -----------------------------------------------------------------------------
comment 3748 Exit the editor
comment 3748 -----------------------------------------------------------------------------
label 3748 Editor_OnExit


comment 374E 
comment 374E -----------------------------------------------------------------------------
comment 374E Load/Save the level package
comment 374E -----------------------------------------------------------------------------
label 374E Editor_SaveLevelPackage
label 3752 Editor_LoadLevelPackage
label 3754 Editor_ReadWritPackage
label 3772 Editor_ReadWritPackage0
label 378F Editor_ReadWritPackage1
label 379F Editor_ReadWritPackage2


comment 37B0 
comment 37B0 -----------------------------------------------------------------------------
comment 37B0 Save the levels
comment 37B0 -----------------------------------------------------------------------------
label 37B0 Editor_OnSaveLevels


comment 37B9 
comment 37B9 -----------------------------------------------------------------------------
comment 37B9 Load the levels.
comment 37B9 -----------------------------------------------------------------------------
label 37B9 Editor_OnLoadLevels




comment 37C5 
comment 37C5 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
comment 37C5 Begin PALET.ASM

comment 37C5 
comment 37C5 -----------------------------------------------------------------------------
comment 37C5 Palette data
comment 37C5 -----------------------------------------------------------------------------
data 37C5-37D4
label 37C5 PALETTE_DATA




comment 37D5 
comment 37D5 
comment 37D5 
comment 37D5 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
comment 37D5 Begin Main Game

comment 37D5 
comment 37D5 -----------------------------------------------------------------------------
comment 37D5 Game Data
comment 37D5 -----------------------------------------------------------------------------
data 37D5
data 37D6-3Aff
label 37D5 STRTL
label 37D6 SCREEN
label 3ACE SCRENE
label 3AF6 SCRENE+$28


comment 3B00 
comment 3B00 -----------------------------------------------------------------------------
comment 3B00 Move player right
comment 3B00 -----------------------------------------------------------------------------
label 3B00 MOVRGT
label 3B11 MOVRG0


comment 3B17 
comment 3B17 -----------------------------------------------------------------------------
comment 3B17 Move player left
comment 3B17 -----------------------------------------------------------------------------
label 3B17 MOVLFT
label 3B27 MOVLF0


comment 3B2E 
comment 3B2E -----------------------------------------------------------------------------
comment 3B2E Move player up
comment 3B2E -----------------------------------------------------------------------------
label 3B2E MOVUP
label 3B40 MOVUP0


comment 3B47 
comment 3B47 -----------------------------------------------------------------------------
comment 3B47 Move player down
comment 3B47 -----------------------------------------------------------------------------
label 3B47 MOVDWN
label 3B5A MOVDW0


comment 3B61 
comment 3B61 -----------------------------------------------------------------------------
comment 3B61 Start new game or test level
comment 3B61 -----------------------------------------------------------------------------
label 3B61 GAME
label 3B93 GAME0


comment 3BC2 
comment 3BC2 -----------------------------------------------------------------------------
comment 3BC2 Main game loop
comment 3BC2 -----------------------------------------------------------------------------
label 3BC2 MAIN
label 3BF9 MAINX
label 3C6C MAIN2
label 3C70 MAIN0
label 3C7F MAIN7
label 3C8D MAIN5


comment 3C9E 
comment 3C9E -----------------------------------------------------------------------------
comment 3C9E Detect if player should fall
comment 3C9E -----------------------------------------------------------------------------
label 3C9E DOFALL
label 3CCE DOFAL0
label 3CD5 DOFAL1
label 3CE4 DOFAL2
label 3CED DOFAL3
label 3CF4 DOFAL9


comment 3CFE 
comment 3CFE -----------------------------------------------------------------------------
comment 3CFE Handle player dig
comment 3CFE -----------------------------------------------------------------------------
label 3CFE DIG
label 3D1C DIG0
label 3D29 DIG1
label 3D55 DIG2
label 3D67 DIGIT
label 3D8B DIGIT0


comment 3D8E 
comment 3D8E -----------------------------------------------------------------------------
comment 3D8E Player input triggered signal handler for moving left 
comment 3D8E -----------------------------------------------------------------------------
label 3D8E MANLFT
label 3DC7 MANLF1
label 3DD6 MANLF2
label 3DD9 MANLF5
label 3DED MANLF0
label 3DFA MANLF9


comment 3E00 
comment 3E00 -----------------------------------------------------------------------------
comment 3E00 Player input triggered signal handler for moving right
comment 3E00 -----------------------------------------------------------------------------
label 3E00 MANRGT
label 3E3A MANRG5
label 3E49 MANRG6
label 3E4C MANRG7
label 3E60 MANRG0
label 3E6F MANRG9


comment 3E75 
comment 3E75 -----------------------------------------------------------------------------
comment 3E75 Player input triggered signal handler for moving up
comment 3E75 -----------------------------------------------------------------------------
label 3E75 MANUP
label 3E7B MANUP0
label 3E99 MANUP2
label 3EC4 MANUP1


comment 3ECA 
comment 3ECA -----------------------------------------------------------------------------
comment 3ECA Player input triggered signal handler for moving down
comment 3ECA -----------------------------------------------------------------------------
label 3ECA MANDN
label 3EDF MANDN0
label 3F0E MANDN1
label 3F1D MANDN9


comment 3F22 
comment 3F22 -----------------------------------------------------------------------------
comment 3F22 Check player input and move accordingly.
comment 3F22 -----------------------------------------------------------------------------
label 3F22 DOMOVE
label 3F31 DOMOV1
label 3F44 DOMOV3
label 3F47 DOMOV4


comment 3F5D 
comment 3F5D -----------------------------------------------------------------------------
comment 3F5D Draw the player sprite on the screen
comment 3F5D -----------------------------------------------------------------------------
label 3F5D PUTMAN


comment 3F79 
comment 3F79 -----------------------------------------------------------------------------
comment 3F79 Check to see if the player has collided with a guard
comment 3F79 -----------------------------------------------------------------------------
label 3F79 CHKMAN
label 3F9B CHKM0
label 3F9D CHKM1
label 3FB5 CHKM8
label 3FB6 CHKM9


comment 3FBB 
comment 3FBB -----------------------------------------------------------------------------
comment 3FBB Draw a guard sprite to the screen
comment 3FBB -----------------------------------------------------------------------------
label 3FBB PUTGRD
label 3FC4 PUTGRX
label 3FC7 PUTGR0
label 3FE7 PUTGR1


comment 3FFE 
comment 3FFE -----------------------------------------------------------------------------
comment 3FFE Restore an 8x9 sized dirty region on the screen
comment 3FFE -----------------------------------------------------------------------------
label 3FFE RESTOR
label 4008 RESTOR0


comment 408F 
comment 408F -----------------------------------------------------------------------------
comment 408F Read the state of the joystick buttons
comment 408F -----------------------------------------------------------------------------
label 408F BUTTON




comment 40A3 
comment 40A3 
comment 40A3 
comment 40A3 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
comment 40A3 Main guard AI movement

comment 40A3 
comment 40A3 -----------------------------------------------------------------------------
comment 40A3 Move guard right
comment 40A3 -----------------------------------------------------------------------------
label 40A3 Guard_MoveRight
label 40B7 Guard_MoveRight0
label 
label 
label 
label 
label 
label 
label 


comment 40BB 
comment 40BB -----------------------------------------------------------------------------
comment 40BB Move guard left
comment 40BB -----------------------------------------------------------------------------
label 40BB Guard_MoveLeft
label 40CD Guard_MoveLeft0


comment 40D2 
comment 40D2 -----------------------------------------------------------------------------
comment 40D2 Move guard up
comment 40D2 -----------------------------------------------------------------------------
label 40D2 Guard_MoveUp
label 40E6 Guard_MoveUp0


comment 40EB 
comment 40EB -----------------------------------------------------------------------------
comment 40EB Move guard down
comment 40EB -----------------------------------------------------------------------------
label 40EB Guard_MoveDown
label 4101 Guard_MoveDown0


comment 4106 
comment 4106 -----------------------------------------------------------------------------
comment 4106 Move guard 
comment 4106 -----------------------------------------------------------------------------
label 4106 Guard_DoFalling


comment 410E 
comment 410E -----------------------------------------------------------------------------
comment 410E Main guard AI and movement
comment 410E -----------------------------------------------------------------------------
label 410E GRDMOV_Done
label 4110 GRDMOV
label 4118 GRDMV0
label 412F GRDMV1
label 4141 GRDMV2
label 414A GRDMV3
label 4153 GRDMV4
label 415C GRDMV5
label 4165 GRDMV6


comment 416B 
comment 416B -----------------------------------------------------------------------------
comment 416B Check to see if a guard should die (closing hole)
comment 416B -----------------------------------------------------------------------------
label 416B Guard_CheckDie
label 419A Guard_CheckDie0


comment 419D 
comment 419D -----------------------------------------------------------------------------
comment 419D Select a new move for the guard
comment 419D -----------------------------------------------------------------------------
label 419D Guard_CheckForNewMove
label 41AC Guard_CheckForNewMove0
label 41CE Guard_CheckForNewMove1
label 4209 Guard_CheckForNewMove2
label 421B Guard_CheckForNewMove3
label 4227 Guard_CheckForNewMove4
label 4245 Guard_CheckForNewMove5
label 4252 Guard_CheckForNewMove6
label 425E Guard_CheckForNewMove7
label 4265 Guard_CheckForNewMove8
label 428C Guard_CheckForNewMove9
label 4293 Guard_CheckForNewMove10
label 42A6 Guard_CheckForNewMove11
label 42B6 Guard_CheckForNewMove12
label 42C2 Guard_CheckForNewMove13
label 42D2 Guard_CheckForNewMove14
label 42DE Guard_CheckForNewMove15
label 4302 Guard_CheckForNewMove16
label 431A Guard_CheckForNewMove17
label 4320 Guard_CheckForNewMove18
label 4345 Guard_CheckForNewMove19
label 4360 Guard_CheckForNewMove20
label 436A Guard_CheckForNewMove21
label 4370 Guard_CheckForNewMove22
label 4375 Guard_CheckForNewMove23
label 437A Guard_CheckForNewMove24
label 437F Guard_CheckForNewMove25
label 43A0 Guard_CheckForNewMove26
label 43B4 Guard_CheckForNewMove27
label 43C1 Guard_CheckForNewMove28
label 43CB Guard_CheckForNewMove29
label 43EE Guard_CheckForNewMove30
label 4404 Guard_CheckForNewMove31
label 440F Guard_CheckForNewMove32
label 441B Guard_CheckForNewMove33


comment 442A 
comment 442A -----------------------------------------------------------------------------
comment 442A Kill the guard and respawn
comment 442A -----------------------------------------------------------------------------
label 442A Guard_Die


comment 4464 
comment 4464 -----------------------------------------------------------------------------
comment 4464 Handle player death
comment 4464 -----------------------------------------------------------------------------
label 4464 KILMAN


comment 447C 
comment 447C -----------------------------------------------------------------------------
comment 447C Run the game over scene
comment 447C -----------------------------------------------------------------------------
data 447C-44E6
word 447D
label 447C Message_GameOver
word 44A4
label 44A3 Message_NewHighScore
label 44E7 Scene_GameOver_Run
label 44F8 Scene_GameOver_Wait
label 4506 Scene_GameOver_Done


comment 4509 
comment 4509 -----------------------------------------------------------------------------
comment 4509 Go to the next level
comment 4509 -----------------------------------------------------------------------------
label 4509 NXTLVL
label 4518 NXTLVL0


comment 4539 
comment 4539 -----------------------------------------------------------------------------
comment 4539 Pauses the game (called when player hits the P key)
comment 4539 -----------------------------------------------------------------------------
label 4539 PAUSE


comment 4542 
comment 4542 -----------------------------------------------------------------------------
comment 4542 Title Text (FIXME: This is defined for high scores, level choice text, and score bar_ SPLIT IT UP)
comment 4542 -----------------------------------------------------------------------------
data 4542-4801
word 4543
label 4542 Message_Copyright


comment 45A0 
comment 45A0 -----------------------------------------------------------------------------
comment 45A0 High Score and editor enable data
comment 45A0 -----------------------------------------------------------------------------
label 45A0 HIGHSCORE_BUFFER
label 46A3 HIGHSCORE_BUFFER_TERM
label 46A4 HIGHSCORE_BUFFER_END


comment 46C2 
comment 46C2 -----------------------------------------------------------------------------
comment 46C2 Level editor and test mode enable (WTF is the rest of it?)
comment 46C2 -----------------------------------------------------------------------------
label 46C2 Editor_EnabledFlag
label 46C7 TestMode_EnabledFlag


comment 47C8 
comment 47C8 -----------------------------------------------------------------------------
comment 47C8 Starting Level message (completed/editor enabled)
comment 47C8 -----------------------------------------------------------------------------
word 47C9
label 47C8 Message_StartLevel
label 47DA Message_StartLevel_Numb


comment 47DD 
comment 47DD -----------------------------------------------------------------------------
comment 47DD Score Bar (bottom of game scene)
comment 47DD -----------------------------------------------------------------------------
word 47De
label 47DD GAMP
label 47E6 LVLP
label 47F0 LIVP
word 47Fa
label 47F9 Message_Score
label 47FC SCRP
label 47FD SCRP+1
label 47FE SCRP+2
label 47FF SCRP+3
label 4800 SCRP+4


comment 4802 
comment 4802 -----------------------------------------------------------------------------
comment 4802 Entry point (exec)
comment 4802 -----------------------------------------------------------------------------
label 4802 EntryPoint
label 4813 EntryPointEx
label 4835 EntryPoint_ClearPaletteLoop


comment 483F 
comment 483F -----------------------------------------------------------------------------
comment 483F Main title scene
comment 483F -----------------------------------------------------------------------------
label 483F Scene_Title_OnGameDone
label 4842 Scene_Title_Run
label 4855 Scene_Title_Run_SetPaletteLoop
label 4874 Scene_Title_Run_PrintLevel
label 4888 Scene_Title_Run_DecodeTitle
label 488F Scene_Title_Run_DecodeTitle_Loop
label 4894 Scene_Title_Run_DecodeTitle_ExpandChunkLoop
label 489B Scene_Title_Run_TransitionIn
label 489E Scene_Menu_Run
label 48C9 Scene_Menu_Run_CheckStart
label 48D5 Scene_Menu_NextLevel
label 48DE Scene_Menu_NextLevelSet
label 48E6 Scene_Menu_PrevLevel
label 48EE Scene_Menu_PrevLevelSet


comment 48F7 
comment 48F7 -----------------------------------------------------------------------------
comment 48F7 High Score Scene
comment 48F7 -----------------------------------------------------------------------------
label 48F7 Scene_HiScore_CheckNew
label 490B Scene_HiScore_Run_FindNext_Loop
label 493B Scene_HiScore_Run_FindNext_Skip
label 4943 Scene_HiScore_Insert
label 4949 Scene_HiScore_Insert_CopyLoop
label 4958 Scene_HiScore_Insert_SetNewEnterName
label 4995 Scene_HiScore_Insert_ClearNameLoop
label 49A3 Scene_HiScore_Insert_CopyNameLoop
label 49AD Scene_HiScore_Insert_Done


comment 49B0 
comment 49B0 -----------------------------------------------------------------------------
comment 49B0 High Score Serialization
comment 49B0 -----------------------------------------------------------------------------
label 49B0 HighScores_Load
label 49B4 HighScores_Save
label 49B6 HighScores_Serialize


comment 49EC 
comment 49EC -----------------------------------------------------------------------------
comment 49EC Test the level
comment 49EC -----------------------------------------------------------------------------
label 49EC TestPlayLevel
